schema {
  query: RootQueryType
}

type Account {
  account_udts(input: AccountChildAccountUdtsInput = {page: 1, page_size: 20, sort_type: DESC}): [AccountUdt]
  contract_code: String
  eth_address: String
  id: Int
  nonce: Int
  registry_address: String
  script: Json
  script_hash: String
  smart_contract: SmartContract
  token_transfer_count: Int
  transaction_count: Int
  type: AccountType
}

input AccountChildAccountUdtsInput {
  """
  argument: the page of query result, the relations of postgres offset: offset = (page - 1) * page_size
  
  default: 1
  limit: > 0
  """
  page: Int = 1

  """
  argument: the page_size of query result, it's the same of postgres limit
  
  default: 20
  limit: > 0
  """
  page_size: Int = 20

  """
  argument: the sort of type by custom condition
  
  default: desc
  """
  sort_type: SortType = DESC
}

type AccountCkb {
  address_hash: String
  balance: Decimal
}

input AccountCkbsInput {
  address_hashes: [String] = []
}

input AccountInput {
  """
  argument: account address(eth_address)
  example: "0x59b670e9fa9d0a427751af201d676719a970857b"
  """
  address: String!
}

enum AccountType {
  ETH_ADDR_REG
  ETH_USER
  META_CONTRACT
  POLYJUICE_CONTRACT
  POLYJUICE_CREATOR
  UDT
  UNKNOWN
}

type AccountUdt {
  account: Account
  address_hash: String
  balance: Decimal
  id: Int
  token_contract_address_hash: String
  udt: Udt
}

input AccountUdtContractAddressInput {
  """
  argument: the page of query result, the relations of postgres offset: offset = (page - 1) * page_size
  
  default: 1
  limit: > 0
  """
  page: Int = 1

  """
  argument: the page_size of query result, it's the same of postgres limit
  
  default: 20
  limit: > 0
  """
  page_size: Int = 20

  """
  argument: the sort of type by custom condition
  
  default: desc
  """
  sort_type: SortType = DESC
  token_contract_address_hash: String!
}

input AccountUdtsInput {
  """
  argument: the list of account udt address
  example: ["0x15ca4f2165ff0e798d9c7434010eaacc4d768d85"]
  """
  address_hashes: [String] = []

  """
  argument: the page of query result, the relations of postgres offset: offset = (page - 1) * page_size
  
  default: 1
  limit: > 0
  """
  page: Int = 1

  """
  argument: the page_size of query result, it's the same of postgres limit
  
  default: 20
  limit: > 0
  """
  page_size: Int = 20

  """
  argument: the address of smart contract which supply udts
  example: "0xbf1f27daea43849b67f839fd101569daaa321e2c"
  """
  token_contract_address_hash: String
}

type Block {
  account: Account
  difficulty: Decimal
  extra_data: String
  gas_limit: Decimal
  gas_used: Decimal
  hash: String
  layer1_block_number: Int
  layer1_tx_hash: String
  logs_bloom: String
  nonce: String
  number: Int
  parent_hash: String
  producer_address: String
  registry_id: Int
  sha3_uncles: String
  size: Int
  state_root: String
  status: BlockStatus
  timestamp: DateTime
  total_difficulty: Decimal
  transaction_count: Int
  transactions(input: PageAndSizeInput = {page: 1, page_size: 5}): [Transaction]
}

input BlockInput {
  hash: String
  number: Int
}

input BlocksInput {
  """
  argument: the page of query result, the relations of postgres offset: offset = (page - 1) * page_size
  
  default: 1
  limit: > 0
  """
  page: Int = 1

  """
  argument: the page_size of query result, it's the same of postgres limit
  
  default: 20
  limit: > 0
  """
  page_size: Int = 20

  """
  argument: the sort of type by custom condition
  
  default: desc
  """
  sort_type: SortType = DESC
}

enum BlockStatus {
  COMMITTED
  FINALIZED
}

"""
The `DateTime` scalar type represents a date and time in the UTC
timezone. The DateTime appears in a JSON response as an ISO8601 formatted
string, including UTC timezone ("Z"). The parsed date and time string will
be converted to UTC if there is an offset.
"""
scalar DateTime

"""
The `Decimal` scalar type represents signed double-precision fractional
values parsed by the `Decimal` library.  The Decimal appears in a JSON
response as a string to preserve precision.

Formally:
sign           ::=  '+' | '-'
digit          ::=  '0' | '1' | '2' | '3' | '4' | '5' | '6' | '7' |
                    '8' | '9'
indicator      ::=  'e' | 'E'
digits         ::=  digit [digit]...
decimal-part   ::=  digits '.' [digits] | ['.'] digits
exponent-part  ::=  indicator [sign] digits
infinity       ::=  'Infinity' | 'Inf'
nan            ::=  'NaN' [digits] | 'sNaN' [digits]
numeric-value  ::=  decimal-part [exponent-part] | infinity
numeric-string ::=  [sign] numeric-value | [sign] nan

Examples:

Some numeric strings are:

    "0"          -- zero
    "12"         -- a whole number
    "-76"        -- a signed whole number
    "12.70"      -- some decimal places
    "+0.003"     -- a plus sign is allowed, too
    "017."       -- the same as 17
    ".5"         -- the same as 0.5
    "4E+9"       -- exponential notation
    "0.73e-7"    -- exponential notation, negative power
    "Inf"        -- the same as Infinity
    "-infinity"  -- the same as -Inf
    "NaN"        -- not-a-Number
    "NaN8275"    -- diagnostic NaN
"""
scalar Decimal

"""
The `Json` scalar type represents arbitrary json string data, represented as UTF-8
character sequences. The Json type is most often used to represent a free-form
human-readable json string.
"""
scalar Json

type Log {
  address_hash: String
  block_hash: String
  block_number: Int
  data: String
  first_topic: String
  fourth_topic: String
  index: Int
  second_topic: String
  third_topic: String
  transaction_hash: String
}

input LogInput {
  address_hash: String

  """argument: the end of block number(inclusive) for search query"""
  end_block_number: Int
  first_topic: String
  fourth_topic: String

  """
  argument: the page of query result, the relations of postgres offset: offset = (page - 1) * page_size
  
  default: 1
  limit: > 0
  """
  page: Int = 1

  """
  argument: the page_size of query result, it's the same of postgres limit
  
  default: 20
  limit: > 0
  """
  page_size: Int = 20
  second_topic: String

  """
  argument: the sort of type by custom condition
  
  default: desc
  """
  sort_type: SortType = DESC

  """argument: the start of block number(inclusive) for search query"""
  start_block_number: Int
  third_topic: String
  transaction_hash: String
}

input PageAndSizeInput {
  """
  argument: the page of query result, the relations of postgres offset: offset = (page - 1) * page_size
  
  default: 1
  limit: > 0
  """
  page: Int = 1

  """
  argument: the page_size of query result, it's the same of postgres limit
  
  default: 20
  limit: > 0
  """
  page_size: Int = 20
}

type Polyjuice {
  gas_limit: Int
  gas_price: Decimal
  gas_used: Int
  id: Int
  input: String
  input_size: Int
  is_create: Boolean
  status: PolyjuiceStatus
  tx_hash: String
  value: Decimal
}

type PolyjuiceCreator {
  code_hash: String
  fee_amount: Decimal
  fee_udt_id: Int
  hash_type: String
  id: Int
  script_args: String
  tx_hash: String
}

enum PolyjuiceStatus {
  FAILED
  SUCCEED
}

type RootQueryType {
  """
  function: get account by account addresses
  
  request-example:
  query {
    account(input: {address: "0x59b670e9fa9d0a427751af201d676719a970857b"}){
      type
      eth_address
    }
  }
  
  result-example:
  {
    "data": {
      "account": {
        "eth_address": "0x59b670e9fa9d0a427751af201d676719a970857b",
        "type": "POLYJUICE_CONTRACT"
      }
    }
  }
  
  request-example-2:
  query {
    account(input: {address: "0xcae7ac7ea158326cc16b4a5f1668924966419455"}){
      type
      eth_address
      account_udts {
        id
        balance
        udt {
          id
          name
          decimal
        }
      }
    }
  }
  
  result-example-2:
  {
    "data": {
      "account": {
        "account_udts": [
          {
            "balance": "2599999999999999997122",
            "id": 527,
            "udt": {
              "decimal": null,
              "id": "80",
              "name": null
            }
          },
          {
            "balance": "2299999999989999656533",
            "id": 524,
            "udt": {
              "decimal": null,
              "id": "1",
              "name": null
            }
          }
        ],
        "eth_address": "0xcae7ac7ea158326cc16b4a5f1668924966419455",
        "type": "ETH_USER"
      }
    }
  }
  """
  account(input: AccountInput!): Account

  """
  function: get list of account ckbs by account addresses
  
  request-example:
  query {
    account_ckbs(input: {address_hashes: ["0x15ca4f2165ff0e798d9c7434010eaacc4d768d85"]}){
      address_hash
      balance
    }
  }
  
  result-example:
  {
    "data": {
      "account_ckbs": [
        {
          "address_hash": "0x15ca4f2165ff0e798d9c7434010eaacc4d768d85",
          "balance": "993799999325"
        }
      ]
    }
  }
  """
  account_ckbs(input: AccountCkbsInput!): [AccountCkb]

  """
  function: get list of account udt by account addresses
  
  request-example:
  query {
    account_udts(input: {address_hashes:
  ["0x15ca4f2165ff0e798d9c7434010eaacc4d768d85",
  "0xc20538aa80bb3ced9e240dc8f8130b7f7d0b0c49"],
        token_contract_address_hash: "0xbf1f27daea43849b67f839fd101569daaa321e2c"}) {
      address_hash
      balance
      udt{
        type
        name
      }
    }
  }
  
  result-example:
  {
    "data": {
      "account_udts": [
        {
          "address_hash": "0x15ca4f2165ff0e798d9c7434010eaacc4d768d85",
          "balance": "993799999325",
          "udt": {
            "name": "Nervos Token",
            "type": "BRIDGE"
          }
        },
        {
          "address_hash": "0xc20538aa80bb3ced9e240dc8f8130b7f7d0b0c49",
          "balance": "950876407191",
          "udt": {
            "name": "Nervos Token",
            "type": "BRIDGE"
          }
        }
      ]
    }
  }
  """
  account_udts(input: AccountUdtsInput!): [AccountUdt]

  """
  function: get list account udts by smart contract address which sort of balance
  
  request-example:
  query {
    account_udts_by_contract_address(input: {token_contract_address_hash:
  "0xbf1f27daea43849b67f839fd101569daaa321e2c", page_size: 2}){
      address_hash
      balance
      udt {
        type
  	    name
      }
    }
  }
  
  result-example:
  {
    "data": {
      "account_udts_by_contract_address": [
        {
          "address_hash": "0x68f5cea51fa6fcfdcc10f6cddcafa13bf6717436",
          "balance": "3711221022882427",
          "udt": {
            "name": "Nervos Token",
            "type": "BRIDGE"
          }
        },
        {
          "address_hash": "0x7c12cbcbc3703bff1230434f792d84d70d47bb6f",
          "balance": "1075120930414037",
          "udt": {
            "name": "Nervos Token",
            "type": "BRIDGE"
          }
        }
      ]
    }
  }
  """
  account_udts_by_contract_address(input: AccountUdtContractAddressInput!): [AccountUdt]

  """
  function: get block by block number or block hash
  
  request-example:
  query {
    block(input: {number: 345600}){
      hash
      parent_hash
      number
      gas_used
      gas_limit
      account{
        id
        eth_address
      }
      transactions (input: {page: 1, page_size: 2}) {
        type
        from_account_id
        to_account_id
      }
    }
  }
  
  result-example:
  {
    "data": {
      "block": {
        "account": {
          "id": 2,
          "eth_address": "0x68f5cea51fa6fcfdcc10f6cddcafa13bf6717436"
        },
        "gas_limit": "981000000",
        "gas_used": "95240385",
        "hash": "0x67dad5ec7f3bc8b5b8f623f4df230cb50c9c39493080a6b32d94023994ba886b",
        "number": 345600,
        "parent_hash": "0x962906210825c339fa4f871239d967c60b62005a6b780ced4334dba56618dbf5",
        "transactions": [
          {
            "from_account_id": 52269,
            "to_account_id": 64241,
            "type": "POLYJUICE"
          },
          {
            "from_account_id": 52920,
            "to_account_id": 197067,
            "type": "POLYJUICE"
          }
        ]
      }
    }
  }
  """
  block(input: BlockInput): Block

  """
  function: get list of block sort by block number
  
  request-example:
  query {
    block(input: {number: 14938}){
      hash
      parent_hash
      number
      gas_used
      gas_limit
  producer_address
      account{
        eth_address
      }
      transactions (input: {page: 1, page_size: 2}) {
        type
        from_account_id
        to_account_id
      }
    }
  }
  
  result-example:
  {
    "data": {
      "block": {
        "account": null,
        "gas_limit": "12500000",
        "gas_used": "0",
        "hash": "0x089f36f4f1eb1060e12ade101e4a6326423fa6cd11915d9bf1ef4bacafdbe663",
        "number": 14938,
        "parent_hash": "0xa552df86bad0233d0acb183056b095ac50abfa93161ff6b62ebe52bac2e53776",
        "producer_address": "715ab282b873b79a7be8b0e8c13c4e8966a52040",
        "transactions": []
      }
    }
  }
  """
  blocks(input: BlocksInput = {page: 1, page_size: 10, sort_type: DESC}): [Block]

  """
  function: get list of logs by filter or conditions
  
  request-example:
  query {
    logs(input: {first_topic: "0x95e0325a2d4f803db1237b0e454f7d9a09ec46941e478e3e98c510d8f1506031",end_block_number:
  9988, page: 1, page_size: 1}) {
      transaction_hash
      block_number
      address_hash
      data
      first_topic
      second_topic
      third_topic
      fourth_topic
    }
  }
  
  result-example:
  {
    "data": {
      "logs": [
        {
          "address_hash": "0x6589f40e144a03da53234dc98a47da36160dbf77",
          "block_number": 9988,
          "data": "0x00000000000000000000000000000000000000000000000000000000000027040000000000000000000000000000000000000000000000000000000000000000",
          "first_topic": "0x95e0325a2d4f803db1237b0e454f7d9a09ec46941e478e3e98c510d8f1506031",
          "fourth_topic": null,
          "second_topic": null,
          "third_topic": null,
          "transaction_hash": "0xeaf751c7eb86b679b7138fac22c603fccb0ca397bccce5a74e5372da7ea12c22"
        }
      ]
    }
  }
  """
  logs(input: LogInput!): [Log]

  """
  function: get smart contract by address
  
  request-example:
  query {
    smart_contract(input: {contract_address: "0xcae7ac7ea158326cc16b4a5f1668924966419455"}) {
      name
      account_id
      account {
        eth_address
      }
    }
  }
  
  result-example:
  {
    "data": {
      "smart_contract": null
    }
  }
  """
  smart_contract(input: SmartContractInput!): SmartContract

  """
  function: get list of smart contracts
  
  request-example:
  query {
    smart_contracts(input: {page: 1, page_size: 2}) {
      name
      account_id
      account {
        eth_address
      }
    }
  }
  
  result-example:
  {
    "data": {
      "smart_contracts": []
    }
  }
  """
  smart_contracts(input: SmartContractsInput = {page: 1, page_size: 20, sort_type: ASC}): [SmartContract]

  """
  function: get list of token transfers by filter
  
  request-example:
  query {
    token_transfers(input: {from_address:
  "0x966b30e576a4d6731996748b48dd67c94ef29067", start_block_number: 1,
  end_block_number:11904, page: 1, page_size: 1, sort_type: DESC}) {
      transaction_hash
      block_number
      to_account{
        eth_address
      }
      to_address
      from_account{
        eth_address
      }
    }
  }
  
  result-example:
  {
    "data": {
      "token_transfers": [
        {
          "block_number": 11904,
          "from_account": {
            "eth_address": "0x966b30e576a4d6731996748b48dd67c94ef29067"
          },
          "to_account": {
            "eth_address": "0xbd6250d17fc557dfe39a9eb3882c421d4c7f6413"
          },
          "to_address": "0xbd6250d17fc557dfe39a9eb3882c421d4c7f6413",
          "transaction_hash": "0x2c70095a3a15a173517fc8d95c505add5242c3287da72907f5ffa1c0b6cc9578"
        }
      ]
    }
  }
  """
  token_transfers(input: TokenTransferInput!): [TokenTransfer]

  """
  function: get transaction by transaction_hash
  
  request-example:
  query {
    transaction (input: {transaction_hash: "0xc7ab89121ab5727b09e007cc04176216e4d5fab1fb0ebe33320b7075e7e54533"}) {
      hash
      block_hash
      block_number
      type
      from_account_id
      to_account_id
    }
  }
  
  result-example:
  {
    "data": {
      "transaction": {
        "block_hash": "0x08b5d6747151e7cc0a2ffd81505d3db39af268c9c1c753a22e7c80890e3b94c5",
        "block_number": 81,
        "from_account_id": 5,
        "hash": "0xc7ab89121ab5727b09e007cc04176216e4d5fab1fb0ebe33320b7075e7e54533",
        "to_account_id": 4,
        "type": "POLYJUICE"
      }
    }
  }
  
  request-example-2:
  query {
    transaction (input: {eth_hash: "0xcdbda9ec578e73e886446d3bd5ca070d77a908be4187fc0e835c7c1598a3fcfa"}) {
      hash
      eth_hash
      block_hash
      block_number
      type
      from_account_id
      to_account_id
    }
  }
  
  result-example-2:
  {
    "data": {
      "transaction": {
        "block_hash": "0x08b5d6747151e7cc0a2ffd81505d3db39af268c9c1c753a22e7c80890e3b94c5",
        "block_number": 81,
        "eth_hash": "0xcdbda9ec578e73e886446d3bd5ca070d77a908be4187fc0e835c7c1598a3fcfa",
        "from_account_id": 5,
        "hash": "0xc7ab89121ab5727b09e007cc04176216e4d5fab1fb0ebe33320b7075e7e54533",
        "to_account_id": 4,
        "type": "POLYJUICE"
      }
    }
  }
  """
  transaction(input: TransactionInput!): Transaction

  """
  function: list transactions by account address
  
  request-example:
  query {
    transactions (input: {address: "0x966b30e576a4d6731996748b48dd67c94ef29067", 
  page: 1, page_size: 2, end_block_number: 15408}) {
      block_hash
      block_number
      type
      from_account_id
  from_account {
        id
        eth_address
      }
      to_account_id
    }
  
  }
  
  {
    "data": {
      "transactions": [
        {
          "block_hash": "0x50505f785e5bfa7b5b13a440eea7b4701368fd539a405d50a03f114ea886e41a",
          "block_number": 15408,
          "from_account": {
            "eth_address": "0x966b30e576a4d6731996748b48dd67c94ef29067",
            "id": 5
          },
          "from_account_id": 5,
          "to_account_id": 1003,
          "type": "POLYJUICE"
        },
        {
          "block_hash": "0x50505f785e5bfa7b5b13a440eea7b4701368fd539a405d50a03f114ea886e41a",
          "block_number": 15408,
          "from_account": {
            "eth_address": "0x966b30e576a4d6731996748b48dd67c94ef29067",
            "id": 5
          },
          "from_account_id": 5,
          "to_account_id": 4,
          "type": "POLYJUICE"
        }
      ]
    }
  }
  """
  transactions(input: TransactionsInput!): [Transaction]

  """
  function: get udt by contract address
  
  request-example:
  query {
    udt(input: {contract_address: "0xbf1f27daea43849b67f839fd101569daaa321e2c"}){
      id
      name
      type
      supply
      account{
        eth_address
      }
    }
  }
  
  result-example:
  {
    "data": {
      "udt": {
        "account": {
          "eth_address": "0xbf1f27daea43849b67f839fd101569daaa321e2c"
        },
        "id": "1",
        "name": "Nervos Token",
        "supply": "693247799.35570027",
        "type": "BRIDGE"
      }
    }
  }
  """
  udt(input: SmartContractInput!): Udt

  """
  function: get list of udts
  
  request-example:
  query {
    udts(input: {page: 1, page_size: 2, sort_type: ASC}){
      id
      name
      type
      supply
      account{
        eth_address
        script_hash
      }
    }
  }
  
  result-example:
  {
    "data": {
      "udts": [
        {
          "account": {
            "eth_address": null,
            "script_hash": "0xbf1f27daea43849b67f839fd101569daaa321e2c"
          },
          "id": "1",
          "name": "Nervos Token",
          "supply": "693247799.35570027",
          "type": "BRIDGE"
        },
        {
          "account": {
            "eth_address": null,
            "script_hash": "0x21ad25fab1d759da1a419a589c0f36dee5e7fe3d"
          },
          "id": "17",
          "name": null,
          "supply": "400000002840",
          "type": "BRIDGE"
        }
      ]
    }
  }
  """
  udts(input: UdtsInput = {page: 1, page_size: 10, sort_type: ASC, type: BRIDGE}): [Udt]
}

type SmartContract {
  abi: [Json]
  account: Account
  account_id: String
  compiler_file_format: String
  compiler_version: String
  constructor_arguments: String
  contract_source_code: String
  deployment_tx_hash: String
  id: Int
  name: String
  other_info: String
}

input SmartContractInput {
  contract_address: String!
}

input SmartContractsInput {
  """
  argument: the page of query result, the relations of postgres offset: offset = (page - 1) * page_size
  
  default: 1
  limit: > 0
  """
  page: Int = 1

  """
  argument: the page_size of query result, it's the same of postgres limit
  
  default: 20
  limit: > 0
  """
  page_size: Int = 20

  """
  argument: the sort of type by custom condition
  
  default: desc
  """
  sort_type: SortType = DESC
}

enum SortType {
  ASC
  DESC
}

type TokenTransfer {
  amount: Decimal
  block: Block
  block_hash: String
  block_number: Int
  from_account: Account
  from_address: String
  log_index: Int
  polyjuice: Polyjuice
  to_account: Account
  to_address: String
  token_contract_address_hash: String
  token_id: Decimal
  transaction: Transaction
  transaction_hash: String
  udt: Udt
}

input TokenTransferInput {
  """argument: the end of block number(inclusive) for search query"""
  end_block_number: Int
  from_address: String

  """
  argument: the page of query result, the relations of postgres offset: offset = (page - 1) * page_size
  
  default: 1
  limit: > 0
  """
  page: Int = 1

  """
  argument: the page_size of query result, it's the same of postgres limit
  
  default: 20
  limit: > 0
  """
  page_size: Int = 20

  """
  argument: the sort of type by custom condition
  
  default: desc
  """
  sort_type: SortType = DESC

  """argument: the start of block number(inclusive) for search query"""
  start_block_number: Int
  to_address: String
  token_contract_address_hash: String
  transaction_hash: String
}

type Transaction {
  args: String
  block: Block
  block_hash: String
  block_number: Int
  eth_hash: String
  from_account: Account
  from_account_id: Int
  hash: String
  index: Int
  nonce: Int
  polyjuice: Polyjuice
  polyjuice_creator: PolyjuiceCreator
  to_account: Account
  to_account_id: Int
  type: TransactionType
}

input TransactionInput {
  eth_hash: String
  transaction_hash: String
}

input TransactionsInput {
  address: String!

  """argument: the end of block number(inclusive) for search query"""
  end_block_number: Int

  """
  argument: the page of query result, the relations of postgres offset: offset = (page - 1) * page_size
  
  default: 1
  limit: > 0
  """
  page: Int = 1

  """
  argument: the page_size of query result, it's the same of postgres limit
  
  default: 20
  limit: > 0
  """
  page_size: Int = 20
  sort: SortType

  """
  argument: the sort of type by custom condition
  
  default: desc
  """
  sort_type: SortType = DESC

  """argument: the start of block number(inclusive) for search query"""
  start_block_number: Int
}

enum TransactionType {
  ETH_ADDRESS_REGISTRY
  POLYJUICE
  POLYJUICE_CREATOR
  UNKNOWN
}

type Udt {
  account: Account
  bridge_account_id: Int
  decimal: Int
  description: String
  icon: String
  id: String
  name: String
  official_site: String
  price: Decimal
  script_hash: String
  supply: Decimal
  symbol: String
  type: UdtType
  type_script: Json
  value: Decimal
}

input UdtsInput {
  """
  argument: the page of query result, the relations of postgres offset: offset = (page - 1) * page_size
  
  default: 1
  limit: > 0
  """
  page: Int = 1

  """
  argument: the page_size of query result, it's the same of postgres limit
  
  default: 20
  limit: > 0
  """
  page_size: Int = 20

  """
  argument: the sort of type by custom condition
  
  default: desc
  """
  sort_type: SortType = DESC
  type: UdtType
}

enum UdtType {
  BRIDGE
  NATIVE
}

